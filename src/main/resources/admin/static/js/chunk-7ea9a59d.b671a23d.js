(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ea9a59d"],{"0af1":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{staticStyle:{width:"100%"},attrs:{size:"medium",multiple:"",filterable:"",clearable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},on:{change:e.handleChange},model:{value:e.selectedLabels,callback:function(t){e.selectedLabels=t},expression:"selectedLabels"}},e._l(e.labels,(function(e,t){return a("el-option",{key:t,attrs:{label:e.labelName,value:e.labelName}})})),1)},n=[],r=(a("4de4"),a("4160"),a("159b"),a("34cd")),i={props:{selectedLabelId:{type:Array}},model:{prop:"selectedLabelId",event:"change"},data:function(){return{labels:[],selectedLabels:[]}},mounted:function(){this.getLabels()},computed:{labelNameMap:function(){var e={};return this.labels.forEach((function(t){e[t.labelName]=t})),e},labelIdMap:function(){var e={};return this.labels.forEach((function(t){e[t.labelId]=t})),e}},methods:{getLabels:function(){var e=this;Object(r["c"])().then((function(t){console.log(t),e.labels=t.data;var a=[];e.selectedLabels.forEach((function(t){a.push(e.labelNameMap[t]["labelId"])})),e.$emit("change",a)}))},handleChange:function(){var e=this,t=this.selectedLabels.filter((function(t){return!e.labelNameMap[t]}));if(0!=t.length)t.forEach((function(t){Object(r["a"])(t).then((function(t){console.log(t),e.getLabels()}))}));else{var a=[];this.selectedLabels.forEach((function(t){a.push(e.labelNameMap[t]["labelId"])})),this.$emit("change",a)}}}},c=i,o=a("2877"),s=Object(o["a"])(c,l,n,!1,null,"40596d82",null);t["a"]=s.exports},2423:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return u}));var l=a("b775");function n(e){return Object(l["a"])({url:"api/admin/articles",method:"get",params:e})}function r(e){return Object(l["a"])({url:"api/admin/articles/".concat(e),method:"get",params:{}})}function i(e){return Object(l["a"])({url:"api/admin/articles/delete",method:"post",params:{id:e}})}function c(e,t){return Object(l["a"])({url:"api/admin/articles/setStatus",method:"post",params:{articleStatus:t,articleId:e}})}function o(e){return Object(l["a"])({url:"/vue-element-admin/article/pv",method:"get",params:{pv:e}})}function s(e){return Object(l["a"])({url:"api/admin/articles/add",method:"post",data:e})}function u(e){return Object(l["a"])({url:"api/admin/articles/update",method:"post",data:e})}},"34cd":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return c}));var l=a("b775");function n(){return Object(l["a"])({url:"api/admin/labels",method:"get",params:{}})}function r(e){return Object(l["a"])({url:"api/admin/labels/addByName",method:"post",params:{labelName:e}})}function i(e){return Object(l["a"])({url:"api/admin/labels/update",method:"post",data:e})}function c(e){return Object(l["a"])({url:"api/admin/labels/delete",method:"post",params:{labelId:e}})}},"792f":function(e,t,a){},baec:function(e,t,a){"use strict";var l=a("792f"),n=a.n(l);n.a},d311:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return c}));var l=a("b775");function n(){return Object(l["a"])({url:"api/admin/sorts",method:"get",params:{}})}function r(e){return Object(l["a"])({url:"api/admin/sorts/delete",method:"post",params:{sortId:e}})}function i(e){return Object(l["a"])({url:"api/admin/sorts/add",method:"post",data:e})}function c(e){return Object(l["a"])({url:"api/admin/sorts/update",method:"post",data:e})}},fdc6:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loaded?a("div",{staticClass:"markdown-container"},[a("mavon-editor",{attrs:{ishljs:!0},model:{value:e.article.articleContent,callback:function(t){e.$set(e.article,"articleContent",t)},expression:"article.articleContent"}}),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("发布")]),a("el-dialog",{attrs:{title:"文章设置",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.article}},[a("el-form-item",{attrs:{label:"文章标题"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.article.articleTitle,callback:function(t){e.$set(e.article,"articleTitle",t)},expression:"article.articleTitle"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.article.articleStatus,callback:function(t){e.$set(e.article,"articleStatus",t)},expression:"article.articleStatus"}},[a("el-radio",{attrs:{label:"publish"}},[e._v("发布")]),a("el-radio",{attrs:{label:"draft"}},[e._v("草稿")])],1)],1),a("el-form-item",{attrs:{label:"发表日期"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间",align:"right","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss","default-value":new Date},model:{value:e.article.createTime,callback:function(t){e.$set(e.article,"createTime",t)},expression:"article.createTime"}})],1),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.article.sort.sortId,callback:function(t){e.$set(e.article.sort,"sortId",t)},expression:"article.sort.sortId"}},e._l(e.sorts,(function(e){return a("el-option",{key:e.sortId,attrs:{label:e.sortName,value:e.sortId}})})),1)],1),a("el-form-item",{attrs:{label:"标签"}},[a("tag-select",{model:{value:e.selectedLabel,callback:function(t){e.selectedLabel=t},expression:"selectedLabel"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handlerCreateArticle}},[e._v("确 定")])],1)],1)],1):e._e()},n=[],r=(a("4160"),a("159b"),a("2423")),i=a("d311"),c=a("0af1"),o={name:"ArticleAdd",components:{TagSelect:c["a"]},data:function(){return{loaded:!1,selectedLabel:[],pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},dialogFormVisible:!1,article:{articleTitle:"",createTime:"",articleSummary:"",articleStatus:"draft",articleContent:"",sort:{sortId:null},labels:[]},sorts:[]}},mounted:function(){this.getSorts()},methods:{getSorts:function(){var e=this;Object(i["c"])().then((function(t){console.log(t),e.sorts=t.data,e.loaded=!0}))},handlerCreateArticle:function(){var e=this;""==this.article.articleTitle?this.$notify({title:"提示",message:"标题不能为空"}):""==this.article.articleContent?this.$notify({title:"提示",message:"内容不能为空"}):(this.selectedLabel.forEach((function(t){e.article.labels.push({labelId:t})})),Object(r["a"])(this.article).then((function(t){console.log(t),200==t.code?(e.$notify({title:"提示",message:"发布成功"}),setTimeout((function(){e.$router.push("/article/list")}),150)):e.$notify({title:"提示",message:t.message})})))}}},s=o,u=(a("baec"),a("2877")),d=Object(u["a"])(s,l,n,!1,null,"86563b0e",null);t["default"]=d.exports}}]);