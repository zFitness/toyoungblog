(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91d867fe"],{2423:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"f",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return u}));var l=a("b775");function i(e){return Object(l["a"])({url:"api/admin/articles",method:"get",params:e})}function n(e){return Object(l["a"])({url:"api/admin/articles/".concat(e),method:"get",params:{}})}function o(e){return Object(l["a"])({url:"api/admin/articles/delete",method:"post",params:{id:e}})}function r(e,t){return Object(l["a"])({url:"api/admin/articles/setStatus",method:"post",params:{articleStatus:t,articleId:e}})}function c(e){return Object(l["a"])({url:"/vue-element-admin/article/pv",method:"get",params:{pv:e}})}function s(e){return Object(l["a"])({url:"api/admin/articles/add",method:"post",data:e})}function u(e){return Object(l["a"])({url:"api/admin/articles/update",method:"post",data:e})}},"7df3":function(e,t,a){"use strict";var l=a("c9cd"),i=a.n(l);i.a},c9cd:function(e,t,a){},fdc6:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"markdown-container"},[a("mavon-editor",{attrs:{ishljs:!0,toolbars:e.isMobile?e.toolbarsMov:void 0,subfield:!e.isMobile},model:{value:e.article.articleContent,callback:function(t){e.$set(e.article,"articleContent",t)},expression:"article.articleContent"}}),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("发布")]),a("el-dialog",{attrs:{title:"文章设置",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.article}},[a("el-form-item",{attrs:{label:"文章标题"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.article.articleTitle,callback:function(t){e.$set(e.article,"articleTitle",t)},expression:"article.articleTitle"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.article.articleStatus,callback:function(t){e.$set(e.article,"articleStatus",t)},expression:"article.articleStatus"}},[a("el-radio",{attrs:{label:"publish"}},[e._v("发布")]),a("el-radio",{attrs:{label:"draft"}},[e._v("草稿")])],1)],1),a("el-form-item",{attrs:{label:"发表日期"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间",align:"right","picker-options":e.pickerOptions},model:{value:e.article.articleDate,callback:function(t){e.$set(e.article,"articleDate",t)},expression:"article.articleDate"}})],1),a("el-form-item",[a("sort-select-tree")],1),a("el-form-item",{attrs:{label:"标签"}},[a("tag-select",{model:{value:e.selectedLabel,callback:function(t){e.selectedLabel=t},expression:"selectedLabel"}})],1),a("el-form-item",{attrs:{label:"摘要"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"为空则自动生成"},model:{value:e.article.articleSummary,callback:function(t){e.$set(e.article,"articleSummary",t)},expression:"article.articleSummary"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handlerCreateArticle}},[e._v("确 定")])],1)],1)],1)},i=[],n=(a("4160"),a("159b"),a("2423")),o=a("b775");function r(){return Object(o["a"])({url:"api/admin/sorts",method:"get",params:{},baseURL:"http://localhost:8080"})}var c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{staticStyle:{width:"100%"},attrs:{size:"medium",multiple:"",filterable:"",clearable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},on:{change:e.handleChange},model:{value:e.selectedLabels,callback:function(t){e.selectedLabels=t},expression:"selectedLabels"}},e._l(e.labels,(function(e,t){return a("el-option",{key:t,attrs:{label:e.labelName,value:e.labelName}})})),1)},s=[];a("4de4");function u(){return Object(o["a"])({url:"api/admin/labels",method:"get",params:{},baseURL:"http://localhost:8080"})}function d(e){return Object(o["a"])({url:"api/admin/labels/addByName",method:"post",params:{labelName:e},baseURL:"http://localhost:8080"})}var m={props:{selectedLabelId:{type:Array}},model:{prop:"selectedLabelId",event:"change"},data:function(){return{labels:[],selectedLabels:[]}},mounted:function(){this.getLabels()},computed:{labelNameMap:function(){var e={};return this.labels.forEach((function(t){e[t.labelName]=t})),e},labelIdMap:function(){var e={};this.labels.forEach((function(t){e[t.labelId]=t}))}},methods:{getLabels:function(){var e=this;u().then((function(t){console.log(t),e.labels=t.data;var a=[];e.selectedLabels.forEach((function(t){a.push(e.labelNameMap[t]["labelId"])})),e.$emit("change",a)}))},handleChange:function(){var e=this,t=this.selectedLabels.filter((function(t){return!e.labelNameMap[t]}));if(0!=t.length)t.forEach((function(t){d(t).then((function(t){console.log(t),e.getLabels()}))}));else{var a=[];this.selectedLabels.forEach((function(t){a.push(e.labelNameMap[t]["labelId"])})),this.$emit("change",a)}}}},f=m,b=a("2877"),h=Object(b["a"])(f,c,s,!1,null,"a804bfb2",null),p=h.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("span",[e._v("分类")]),a("el-tree",{attrs:{props:e.props,load:e.loadNode,lazy:"","show-checkbox":""},on:{"check-change":e.handleCheckChange}}),a("el-button",{attrs:{size:"mini"}},[e._v("添加")])],1)},v=[],k=(a("b0c0"),{data:function(){return{props:{label:"name",children:"zones"},count:1}},methods:{handleCheckChange:function(e,t,a){console.log(e,t,a)},handleNodeClick:function(e){console.log(e)},loadNode:function(e,t){var a,l=this;return 0===e.level?t([{name:"region1"},{name:"region2"}]):e.level>3?t([]):(a="region1"===e.data.name||"region2"!==e.data.name&&Math.random()>.5,void setTimeout((function(){var e;e=a?[{name:"zone"+l.count++},{name:"zone"+l.count++}]:[],t(e)}),500))}}}),w=k,y=Object(b["a"])(w,g,v,!1,null,"291a6632",null),L=y.exports,C={name:"ArticleModify",components:{TagSelect:p,SortSelectTree:L},data:function(){return{selectedLabel:[],count:1,newSort:[],pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},dialogFormVisible:!1,article:{articleTitle:"",articleDate:new Date,articleSummary:"",articleStatus:"draft",articleContent:"",sort:{sortId:null},labels:[]},windowWidth:document.documentElement.clientWidth,isMobile:!1,toolbarsMov:{link:!0,imagelink:!0,undo:!0,redo:!0,preview:!0},sorts:[],labels:[]}},computed:{language:function(){}},watch:{windowWidth:function(e){console.log(e),this.isMobile=this.windowWidth<768}},mounted:function(){this.getSorts();var e=this;window.onresize=function(){return function(){window.fullWidth=document.documentElement.clientWidth,e.windowWidth=window.fullWidth}()}},methods:{getSorts:function(){var e=this;r().then((function(t){console.log(t),e.sorts=t.data}))},handlerCreateArticle:function(){var e=this;""==this.article.articleTitle?this.$notify({title:"提示",message:"标题不能为空"}):""==this.article.articleContent?this.$notify({title:"提示",message:"内容不能为空"}):(this.selectedLabel.forEach((function(t){e.article.labels.push({labelId:t})})),Object(n["a"])(this.article).then((function(t){console.log(t),2e4==t.code&&(e.$notify({title:"提示",message:"发布成功"}),setTimeout((function(){e.$router.push("/article/list")}),150))})))},getArticle:function(){var e=this;console.log(this.$route.params.id),fetchArticle(this.$route.params.id).then((function(t){console.log(t),e.article=t.data}))}}},$=C,S=(a("7df3"),Object(b["a"])($,l,i,!1,null,"0146947c",null));t["default"]=S.exports}}]);